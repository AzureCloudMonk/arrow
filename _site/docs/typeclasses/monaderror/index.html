<h2 id="monaderror">MonadError</h2>

<p>MonadError is the typeclass used to explicitly represent errors during sequential execution.
It is parametrized to an error type <code class="highlighter-rouge">E</code>, which means the datatype has at least a “success” and a “failure” version.
These errors can come in the form of <code class="highlighter-rouge">Throwable</code>, <code class="highlighter-rouge">Exception</code>, or any other type hierarchy of the user’s choice.</p>

<p><code class="highlighter-rouge">MonadError</code> extends from <a href="/docs/typeclasses/applicativeerror"><code class="highlighter-rouge">ApplicativeError</code></a>, which is already used to represent errors in independent computations. This way all the methods <a href="/docs/typeclasses/applicativeerror"><code class="highlighter-rouge">ApplicativeError</code></a> provides to handle recovery from errors are also available in <code class="highlighter-rouge">MonadError</code>.</p>

<h3 id="main-combinators">Main Combinators</h3>

<p><code class="highlighter-rouge">MonadError</code> inherits all the combinators available in <a href="/docs/typeclasses/applicativeerror"><code class="highlighter-rouge">ApplicativeError</code></a> and <a href="/docs/typeclasses/monad"><code class="highlighter-rouge">Monad</code></a>. It also adds one of its own.</p>

<h4 id="raiseerror">raiseError</h4>

<p>Inherited from <a href="/docs/typeclasses/applicativeerror"><code class="highlighter-rouge">ApplicativeError</code></a>. A constructor function.
It lifts an exception into the computational context of a type constructor.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">arrow.*</span>
<span class="k">import</span> <span class="nn">arrow.core.*</span>

<span class="n">Either</span><span class="p">.</span><span class="n">monadError</span><span class="p">&lt;</span><span class="n">Throwable</span><span class="p">&gt;().</span><span class="n">raiseError</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">&gt;(</span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">"Paco"</span><span class="p">))</span>
<span class="c1">// Left(a=java.lang.RuntimeException: Paco)</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">arrow.data.*</span>

<span class="n">Try</span><span class="p">.</span><span class="n">monadError</span><span class="p">().</span><span class="n">raiseError</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">&gt;(</span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">"Paco"</span><span class="p">))</span>
<span class="c1">// Failure(exception=java.lang.RuntimeException: Paco)</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">arrow.effects.*</span>

<span class="n">IO</span><span class="p">.</span><span class="n">monadError</span><span class="p">().</span><span class="n">raiseError</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">&gt;(</span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">"Paco"</span><span class="p">))</span>
<span class="c1">// RaiseError(exception=java.lang.RuntimeException: Paco)</span>
</code></pre></div></div>

<h4 id="kindf-aensure">Kind&lt;F, A&gt;.ensure</h4>

<p>Tests a predicate against the object, and if it fails it executes a function to create an error.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">ME</span> <span class="p">=</span> <span class="n">Either</span><span class="p">.</span><span class="n">monadError</span><span class="p">&lt;</span><span class="n">Throwable</span><span class="p">&gt;()</span>

<span class="kd">val</span> <span class="py">either</span><span class="p">:</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">Throwable</span><span class="p">,</span> <span class="n">Int</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">Either</span><span class="p">.</span><span class="n">Right</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="n">ME</span><span class="p">.</span><span class="n">run</span> <span class="p">{</span> <span class="n">either</span><span class="p">.</span><span class="n">ensure</span><span class="p">({</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">"Failed predicate"</span><span class="p">)</span> <span class="p">},</span> <span class="p">{</span> <span class="n">it</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">})</span> <span class="p">}</span>
<span class="c1">// Right(b=1)</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ME</span><span class="p">.</span><span class="n">run</span> <span class="p">{</span> <span class="n">either</span><span class="p">.</span><span class="n">ensure</span><span class="p">({</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="s">"Failed predicate"</span><span class="p">)</span> <span class="p">},</span> <span class="p">{</span> <span class="n">it</span> <span class="p">&lt;</span> <span class="m">0</span> <span class="p">})</span> <span class="p">}</span>
<span class="c1">// Left(a=java.lang.RuntimeException: Failed predicate)</span>
</code></pre></div></div>

<h3 id="comprehensions">Comprehensions</h3>

<h4 id="bindingcatch">bindingCatch</h4>

<p>It starts a <a href="/docs/patterns/monadcomprehensions">Monad Comprehension</a> that wraps any exception thrown in the block inside <code class="highlighter-rouge">raiseError()</code>.</p>

<h3 id="laws">Laws</h3>

<p>Arrow provides <a href="/docs/typeclasses/laws#monaderrorlaws"><code class="highlighter-rouge">MonadErrorLaws</code></a> in the form of test cases for internal verification of lawful instances and third party apps creating their own <code class="highlighter-rouge">MonadError</code> instances.</p>

<h3 id="data-types">Data types</h3>

<p>The following datatypes in Arrow provide instances that adhere to the <code class="highlighter-rouge">MonadError</code> typeclass.</p>

<ul>
  <li><a href="/docs/datatypes/try">Try</a></li>
  <li><a href="/docs/datatypes/either">Either</a></li>
  <li><a href="/docs/datatypes/kleisli">Kleisli</a></li>
  <li><a href="/docs/datatypes/option">Option</a></li>
  <li><a href="/docs/datatypes/eithert">EitherT</a></li>
  <li><a href="/docs/datatypes/statet">StateT</a></li>
  <li><a href="/docs/effects/io">IO</a></li>
  <li><a href="/docs/integrations/rx2">ObservableK</a></li>
  <li><a href="/docs/integrations/rx2">FlowableK</a></li>
  <li><a href="/docs/integrations/kotlinxcoroutines/">DeferredK</a></li>
</ul>
